<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calculadora Lámina Acústica Vinyl</title>
  <link rel="icon" href="kayalac-favicon.png" type="image/png" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: url('fondo.jpg') no-repeat center center fixed;
      background-size: cover;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 10px;
      margin-top: 30px;
    }
    input, select {
      width: 90px;
      padding: 5px;
      margin: 5px;
    }
    .hidden {
      display: none;
    }
    canvas {
      border: 1px solid #000;
      margin-top: 20px;
      display: block;
      max-width: 100%;
    }
    ul li {
      list-style-type: circle;
    }
    #whatsappBtn {
      background-color: #90ee90;
      color: black;
      padding: 8px 12px;
      border-radius: 6px;
      text-decoration: none;
      display: inline-block;
      margin-top: 10px;
    }
    .legend {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    .legend-item {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 12px;
    }
    .color-box {
      width: 14px;
      height: 14px;
      display: inline-block;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2><img src="kayalac-logo.png" alt="Kayalac Logo" height="40" /></h2>
    <form id="calcForm">
      <label for="width">Ancho del área (ft):</label>
      <input type="number" id="width" required maxlength="5" />

      <label for="length">Largo del área (ft):</label>
      <input type="number" id="length" required maxlength="5" />

      <label for="panelType">Tamaño de panel:</label>
      <select id="panelType">
        <option value="24x24">24" x 24"</option>
        <option value="24x48">24" x 48"</option>
      </select>

      <button type="submit">Calcular</button>
    </form>

    <div id="result" class="hidden">
      <h4>Resultados:</h4>
      <ul id="outputList"></ul>
      <a id="whatsappBtn" href="#" target="_blank">Compartir por WhatsApp</a>
    </div>

    <div id="layoutContainer" class="hidden">
      <canvas id="layoutCanvas"></canvas>
      <div class="legend">
        <div class="legend-item"><span class="color-box" style="background:#0B3D91"></span> Lámina Vinyl</div>
        <div class="legend-item"><span class="color-box" style="background:yellow"></span> Cross Tee 2 ft</div>
        <div class="legend-item"><span class="color-box" style="background:skyblue"></span> Cross Tee 4 ft</div>
        <div class="legend-item"><span class="color-box" style="background:green"></span> Main Tee</div>
        <div class="legend-item"><span class="color-box" style="background:maroon"></span> Ángulo 10 ft</div>
      </div>
    </div>
  </div>

  <script>
    document.getElementById("calcForm").addEventListener("submit", function (e) {
      e.preventDefault();

      const width = parseFloat(document.getElementById("width").value);
      const length = parseFloat(document.getElementById("length").value);
      const panelType = document.getElementById("panelType").value;

      if (!width || !length || width <= 0 || length <= 0) {
        alert("Por favor, ingresa medidas válidas para ancho y largo.");
        return;
      }

      const panelSize = panelType === "24x24" ? { width: 2, length: 2 } : { width: 2, length: 4 };

      const area = width * length;
      const panelArea = panelSize.width * panelSize.length;
      const panelCount = Math.ceil(area / panelArea);

      const mainTeeSpacing = 4;
      const crossTee4Spacing = 2;
      const mainTeeCount = Math.ceil(length / mainTeeSpacing) + 1;
      const crossTee4Count = Math.ceil(width / crossTee4Spacing) * mainTeeCount;

      const crossTee2Count = panelType === "24x24" ? Math.ceil(width / 2) * Math.ceil(length / 2) : 0;
      const perimeter = 2 * (width + length);
      const angleCount = Math.ceil(perimeter / 10);

      const clavosCount = angleCount * 5;
      const clavosToUse = clavosCount > 100 ? "1 kg" : clavosCount + " unidades";

      const wirePounds = Math.ceil(mainTeeCount / 5);

      // Mostrar resultados
      const resultBox = document.getElementById("result");
      const outputList = document.getElementById("outputList");
      resultBox.classList.remove("hidden");
      outputList.innerHTML = `
        <li>Área total: ${area.toFixed(2)} ft²</li>
        <li>Láminas Vinyl: ${panelCount}</li>
        <li>Main Tees: ${mainTeeCount}</li>
        <li>Cross Tee 4 ft: ${crossTee4Count}</li>
        <li>Cross Tee 2 ft: ${crossTee2Count}</li>
        <li>Ángulos perimetrales 10 ft: ${angleCount}</li>
        <li>Clavos de 1\": ${clavosToUse}</li>
        <li>Alambre galvanizado 16#: ${wirePounds} lb</li>
      `;

      const whatsappText = encodeURIComponent(
        `Resultado Kayalac:\nÁrea: ${area.toFixed(2)} ft²\nLáminas: ${panelCount}\nMain Tees: ${mainTeeCount}\nCross Tee 4 ft: ${crossTee4Count}\nCross Tee 2 ft: ${crossTee2Count}\nÁngulos: ${angleCount}\nClavos 1\": ${clavosToUse}\nAlambre 16#: ${wirePounds} lb`
      );
      document.getElementById("whatsappBtn").href = `https://wa.me/?text=${whatsappText}`;

      drawLayout(width, length, panelSize);
    });

    function drawLayout(widthFt, lengthFt, panelSize) {
      const canvas = document.getElementById("layoutCanvas");
      const container = document.getElementById("layoutContainer");
      container.classList.remove("hidden");

      const ctx = canvas.getContext("2d");

      const scale = 20;
      const margin = 40;

      canvas.width = widthFt * scale + margin * 2;
      canvas.height = lengthFt * scale + margin * 2;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw grid
      ctx.translate(margin, margin);

      for (let y = 0; y < lengthFt; y += panelSize.length) {
        for (let x = 0; x < widthFt; x += panelSize.width) {
          ctx.fillStyle = "#0B3D91";
          ctx.fillRect(x * scale, y * scale, panelSize.width * scale, panelSize.length * scale);
          ctx.strokeStyle = "white";
          ctx.lineWidth = 0.5;
          ctx.strokeRect(x * scale, y * scale, panelSize.width * scale, panelSize.length * scale);
        }
      }

      ctx.resetTransform();

      // Draw dimensions
      ctx.fillStyle = "#000";
      ctx.font = "14px Arial";
      ctx.fillText(`Ancho: ${widthFt} ft`, canvas.width / 2 - 40, 15);
      ctx.save();
      ctx.translate(10, canvas.height / 2);
      ctx.rotate(-Math.PI / 2);
      ctx.fillText(`Largo: ${lengthFt} ft`, -30, 0);
      ctx.restore();
    }
  </script>
</body>
</html>
